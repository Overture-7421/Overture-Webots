#VRML_SIM R2023b utf8
# Describe the functionality of your PROTO here.
EXTERNPROTO "https://raw.githubusercontent.com/cyberbotics/webots/R2023b/projects/appearances/protos/BrushedAluminium.proto"

PROTO SwerveDrive [
  field SFVec3f translation 0 0 0
  field SFRotation rotation 0 0 1 0
  field SFString name "Sample Robot"
  field SFString controller "nt_robot_controller"
  field MFString controllerArgs [
"{\"type\": \"motor\", \"value\": {\"name\": \"front_right\", \"suffix\": \"\", \"model\": \"Falcon\", \"gear_ratio\": 21.4285714286, \"count\": 1, \"mechanically_inverted\": true}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"front_left\", \"suffix\": \"\", \"model\": \"Falcon\", \"gear_ratio\": 21.4285714286, \"count\": 1, \"mechanically_inverted\": true}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"back_right\", \"suffix\": \"\", \"model\": \"Falcon\", \"gear_ratio\": 21.4285714286, \"count\": 1, \"mechanically_inverted\": true}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"back_left\", \"suffix\": \"\", \"model\": \"Falcon\", \"gear_ratio\": 21.4285714286, \"count\": 1, \"mechanically_inverted\": true}}",
    
    "{\"type\": \"motor\", \"value\": {\"name\": \"front_right_drive\", \"suffix\": \"\", \"model\": \"Kraken\", \"gear_ratio\": 5.9027777, \"count\": 1, \"mechanically_inverted\": false}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"front_left_drive\", \"suffix\": \"\", \"model\": \"Kraken\", \"gear_ratio\": 5.9027777, \"count\": 1, \"mechanically_inverted\": false}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"back_right_drive\", \"suffix\": \"\", \"model\": \"Kraken\", \"gear_ratio\": 5.9027777, \"count\": 1, \"mechanically_inverted\": false}}",
    "{\"type\": \"motor\", \"value\": {\"name\": \"back_left_drive\", \"suffix\": \"\", \"model\": \"Kraken\", \"gear_ratio\": 5.9027777, \"count\": 1, \"mechanically_inverted\": false}}",
    
    "{\"type\": \"cancoder\", \"value\": {\"name\": \"front_right_cancoder\", \"inverted\": false}}",
    "{\"type\": \"cancoder\", \"value\": {\"name\": \"front_left_cancoder\", \"inverted\": false}}",
    "{\"type\": \"cancoder\", \"value\": {\"name\": \"back_right_cancoder\", \"inverted\": false}}",
    "{\"type\": \"cancoder\", \"value\": {\"name\": \"back_left_cancoder\", \"inverted\": false}}"
  ]
  
  field SFString window "<generic>"
  field SFBool   supervisor FALSE
  field SFBool   synchronization TRUE
  field SFBool   selfCollision FALSE
]
{
  Robot {
    translation IS translation
    rotation IS rotation
    name IS name
    controller IS controller
    children [
      Accelerometer {
      }
      Gyro {
      }
      InertialUnit {
      }
      DEF CHASSIS_SHAPES Pose {
        translation 0.0 0.0 0.0
        rotation 0.0 0.0 0.0 0.0
        children [
          DEF CHASSIS Shape {
            appearance DEF METAL_PART BrushedAluminium {
              textureTransform TextureTransform {
                scale 20 20
              }
            }
            geometry Mesh {
              url "../models/TestChassis/Swerve.dae"
            }
          }
        ]
      }

     
     
#FRONT RIGHT Module
      
DEF FRONT_RIGHT_JOINT HingeJoint {
  jointParameters HingeJointParameters {
    anchor 0.2597 -0.2597 -0.018
    axis 0 0 1
    staticFriction 0.1
    dampingConstant 8.0
  }
  device [
    PositionSensor {
      name "front_right_cancoder"
    }
    RotationalMotor {
      name "front_right"
      maxTorque 999999
    }
  ]
  endPoint Solid {
    name "Front Right Solid"
    translation 0.2597 -0.2597 -0.018
    children [
      Shape {
        geometry Box {
          size 0.08 0.08 0.1
        }
      }
      DEF FRONT_RIGHT_DRIVE_JOINT HingeJoint {
        jointParameters HingeJointParameters {
          anchor 0.0 -0.0 -0.05
          axis 0 1 0
          staticFriction 1.0
          dampingConstant 0.1
        }
        device [
          PositionSensor {
            name "front_right_drive_cancoder"
          }
          RotationalMotor {
            name "front_right_drive"
            maxTorque 999999
          }
        ]
        endPoint Solid {
          translation 0.0 -0.0 -0.05
          rotation 1.0 0.0 0.0 1.57
          children [
            Shape {
              geometry Cylinder {
                height 0.03732276
                radius 0.035
              }
            }
          ]
          boundingObject Cylinder {
            height 0.03732276
            radius 0.035
          }
          physics Physics {
            density -1
            mass 0.5
            centerOfMass [0.0 0.0 0.0]
          }
        }
      }
    ]
    boundingObject Box {
      size 0.08 0.08 0.1
    }
    physics Physics {
      density -1
      mass 2.0
      centerOfMass [0.0 0.0 0.0]
    }
  }
}

          
          
#FRONT LEFT Module
DEF FRONT_LEFT_JOINT HingeJoint {
  jointParameters HingeJointParameters {
    anchor 0.2597 0.2597 -0.018
    axis 0 0 1
    staticFriction 0.1
    dampingConstant 8.0
  }
  device [
    PositionSensor {
      name "front_left_cancoder"
    }
    RotationalMotor {
      name "front_left"
      maxTorque 999999
    }
  ]
  endPoint Solid {
    name "Front Left Solid"
    translation 0.2597 0.2597 -0.018
    children [
      Shape {
        geometry Box {
          size 0.08 0.08 0.1
        }
      }
      DEF FRONT_RIGHT_DRIVE_JOINT HingeJoint {
        jointParameters HingeJointParameters {
          anchor 0.0 0.0 -0.05
          axis 0 1 0
          staticFriction 1.0
          dampingConstant 0.1
        }
        device [
          PositionSensor {
            name "front_left_drive_cancoder"
          }
          RotationalMotor {
            name "front_left_drive"
            maxTorque 999999
          }
        ]
        endPoint Solid {
          translation 0.0 0.0 -0.05
          rotation 1.0 0.0 0.0 1.57
          children [
            Shape {
              geometry Cylinder {
                height 0.03732276
                radius 0.035
              }
            }
          ]
          boundingObject Cylinder {
            height 0.03732276
            radius 0.035
          }
          physics Physics {
            density -1
            mass 0.5
            centerOfMass [0.0 0.0 0.0]
          }
        }
      }
    ]
    boundingObject Box {
      size 0.08 0.08 0.1
    }
    physics Physics {
      density -1
      mass 2.0
      centerOfMass [0.0 0.0 0.0]
    }
  }
}

#BACK RIGHT Module
DEF BACK_RIGHT_JOINT HingeJoint {
  jointParameters HingeJointParameters {
    anchor -0.2597 -0.2597 -0.018
    axis 0 0 1
    staticFriction 0.1
    dampingConstant 8.0
  }
  device [
    PositionSensor {
      name "back_right_cancoder"
    }
    RotationalMotor {
      name "back_right"
      maxTorque 999999
    }
  ]
  endPoint Solid {
    name "Back Right Solid"
    translation -0.2597 -0.2597 -0.018
    children [
      Shape {
        geometry Box {
          size 0.08 0.08 0.1
        }
      }
      DEF BACK_RIGHT_DRIVE_JOINT HingeJoint {
        jointParameters HingeJointParameters {
          anchor 0.0 0.0 -0.05
          axis 0 1 0
          staticFriction 1.0
          dampingConstant 0.1
        }
        device [
          PositionSensor {
            name "back_right_drive_cancoder"
          }
          RotationalMotor {
            name "back_right_drive"
            maxTorque 999999
          }
        ]
        endPoint Solid {
          translation 0.0 0.0 -0.05
          rotation 1.0 0.0 0.0 1.57
          children [
            Shape {
              geometry Cylinder {
                height 0.03732276
                radius 0.035
              }
            }
          ]
          boundingObject Cylinder {
            height 0.03732276
            radius 0.035
          }
          physics Physics {
            density -1
            mass 0.5
            centerOfMass [0.0 0.0 0.0]
          }
        }
      }
    ]
    boundingObject Box {
      size 0.08 0.08 0.1
    }
    physics Physics {
      density -1
      mass 2.0
      centerOfMass [0.0 0.0 0.0]
    }
  }
}

#BACK LEFT Module
DEF BACK_LEFT_JOINT HingeJoint {
  jointParameters HingeJointParameters {
    anchor -0.2597 0.2597 -0.018
    axis 0 0 1
    staticFriction 0.1
    dampingConstant 8.0
  }
  device [
    PositionSensor {
      name "back_left_cancoder"
    }
    RotationalMotor {
      name "back_left"
      maxTorque 999999
    }
  ]
  endPoint Solid {
    name "Back Left Solid"
    translation -0.2597 0.2597 -0.018
    children [
      Shape {
        geometry Box {
          size 0.08 0.08 0.1
        }
      }
      DEF FRONT_RIGHT_DRIVE_JOINT HingeJoint {
        jointParameters HingeJointParameters {
          anchor 0.0 0.0 -0.05
          axis 0 1 0
          staticFriction 1.0
          dampingConstant 0.1
        }
        device [
          PositionSensor {
            name "back_left_drive_cancoder"
          }
          RotationalMotor {
            name "back_left_drive"
            maxTorque 999999
          }
        ]
        endPoint Solid {
          translation 0.0 0.0 -0.05
          rotation 1.0 0.0 0.0 1.57
          children [
            Shape {
              geometry Cylinder {
                height 0.03732276
                radius 0.035
              }
            }
          ]
          boundingObject Cylinder {
            height 0.03732276
            radius 0.035
          }
          physics Physics {
            density -1
            mass 0.5
            centerOfMass [0.0 0.0 0.0]
          }
        }
      }
    ]
    boundingObject Box {
      size 0.08 0.08 0.1
    }
    physics Physics {
      density -1
      mass 2.0
      centerOfMass [0.0 0.0 0.0]
    }
  }
}

]
    
    boundingObject DEF BODY_BO Group {
      children [
        Pose {
          translation 0.0 0.0 0.0
          rotation 0.0 0.0 0.0 0.0
          children [
            Box {
              size 0.8 0.67 0.1
            }
          ]
        }
      ]
    }
    physics Physics {
      density -1
      mass 15
      centerOfMass [
        0.0 0.0 0.0
      ]
    }    
    
    controller IS controller
    controllerArgs IS controllerArgs
    window IS window
    synchronization IS synchronization
    selfCollision IS selfCollision
    supervisor IS supervisor
  }
}